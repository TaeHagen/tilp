var _n=Object.defineProperty;var mn=(t,e,n)=>e in t?_n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Re=(t,e,n)=>(mn(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function M(){}const Ut=t=>t;function bn(t,e){for(const n in e)t[n]=e[n];return t}function hn(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function qt(t){return t()}function bt(){return Object.create(null)}function te(t){t.forEach(qt)}function me(t){return typeof t=="function"}function ne(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function pn(t){return Object.keys(t).length===0}function Je(t,...e){if(t==null)return M;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ee(t){let e;return Je(t,n=>e=n)(),e}function Nt(t,e,n,l){if(t){const s=Ht(t,e,n,l);return t[0](s)}}function Ht(t,e,n,l){return t[1]&&l?bn(n.ctx.slice(),t[1](l(e))):n.ctx}function zt(t,e,n,l){if(t[2]&&l){const s=t[2](l(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const i=[],o=Math.max(e.dirty.length,s.length);for(let r=0;r<o;r+=1)i[r]=e.dirty[r]|s[r];return i}return e.dirty|s}return e.dirty}function Vt(t,e,n,l,s,i){if(s){const o=Ht(e,n,l,i);t.p(o,s)}}function Kt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function le(t){return t??""}const Yt=typeof window<"u";let yn=Yt?()=>window.performance.now():()=>Date.now(),Xe=Yt?t=>requestAnimationFrame(t):M;const ve=new Set;function Gt(t){ve.forEach(e=>{e.c(t)||(ve.delete(e),e.f())}),ve.size!==0&&Xe(Gt)}function gn(t){let e;return ve.size===0&&Xe(Gt),{promise:new Promise(n=>{ve.add(e={c:t,f:n})}),abort(){ve.delete(e)}}}function v(t,e){t.appendChild(e)}function Zt(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function wn(t){const e=y("style");return vn(Zt(t),e),e.sheet}function vn(t,e){return v(t.head||t,e),e.sheet}function w(t,e,n){t.insertBefore(e,n||null)}function g(t){t.parentNode&&t.parentNode.removeChild(t)}function qe(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function y(t){return document.createElement(t)}function I(t){return document.createTextNode(t)}function O(){return I(" ")}function Se(){return I("")}function R(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function p(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function kn(t){return Array.from(t.childNodes)}function he(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function F(t,e,n,l){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}function se(t,e,n){t.classList[n?"add":"remove"](e)}function Jt(t,e,{bubbles:n=!1,cancelable:l=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,l,e),s}function Ne(t,e){return new t(e)}const He=new Map;let ze=0;function Cn(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Bn(t,e){const n={stylesheet:wn(e),rules:{}};return He.set(t,n),n}function ht(t,e,n,l,s,i,o,r=0){const u=16.666/l;let c=`{
`;for(let d=0;d<=1;d+=u){const A=e+(n-e)*i(d);c+=d*100+`%{${o(A,1-A)}}
`}const a=c+`100% {${o(n,1-n)}}
}`,f=`__svelte_${Cn(a)}_${r}`,h=Zt(t),{stylesheet:k,rules:_}=He.get(h)||Bn(h,t);_[f]||(_[f]=!0,k.insertRule(`@keyframes ${f} ${a}`,k.cssRules.length));const b=t.style.animation||"";return t.style.animation=`${b?`${b}, `:""}${f} ${l}ms linear ${s}ms 1 both`,ze+=1,f}function Wn(t,e){const n=(t.style.animation||"").split(", "),l=n.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),s=n.length-l.length;s&&(t.style.animation=l.join(", "),ze-=s,ze||Tn())}function Tn(){Xe(()=>{ze||(He.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&g(e)}),He.clear())})}let Oe;function ae(t){Oe=t}function Be(){if(!Oe)throw new Error("Function called outside component initialization");return Oe}function En(t){Be().$$.on_mount.push(t)}function On(t){Be().$$.on_destroy.push(t)}function xe(){const t=Be();return(e,n,{cancelable:l=!1}={})=>{const s=t.$$.callbacks[e];if(s){const i=Jt(e,n,{cancelable:l});return s.slice().forEach(o=>{o.call(t,i)}),!i.defaultPrevented}return!0}}function Sn(t,e){return Be().$$.context.set(t,e),e}function Qt(t){return Be().$$.context.get(t)}function Fn(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(l=>l.call(this,e))}const we=[],ke=[],Ie=[],pt=[],Mn=Promise.resolve();let Qe=!1;function Ln(){Qe||(Qe=!0,Mn.then($e))}function Ce(t){Ie.push(t)}const Ye=new Set;let ye=0;function $e(){if(ye!==0)return;const t=Oe;do{try{for(;ye<we.length;){const e=we[ye];ye++,ae(e),Dn(e.$$)}}catch(e){throw we.length=0,ye=0,e}for(ae(null),we.length=0,ye=0;ke.length;)ke.pop()();for(let e=0;e<Ie.length;e+=1){const n=Ie[e];Ye.has(n)||(Ye.add(n),n())}Ie.length=0}while(we.length);for(;pt.length;)pt.pop()();Qe=!1,Ye.clear(),ae(t)}function Dn(t){if(t.fragment!==null){t.update(),te(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ce)}}let Ee;function Pn(){return Ee||(Ee=Promise.resolve(),Ee.then(()=>{Ee=null})),Ee}function Ge(t,e,n){t.dispatchEvent(Jt(`${e?"intro":"outro"}${n}`))}const Ue=new Set;let fe;function Q(){fe={r:0,c:[],p:fe}}function X(){fe.r||te(fe.c),fe=fe.p}function E(t,e){t&&t.i&&(Ue.delete(t),t.i(e))}function S(t,e,n,l){if(t&&t.o){if(Ue.has(t))return;Ue.add(t),fe.c.push(()=>{Ue.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}const An={duration:0};function je(t,e,n,l){const s={direction:"both"};let i=e(t,n,s),o=l?0:1,r=null,u=null,c=null;function a(){c&&Wn(t,c)}function f(k,_){const b=k.b-o;return _*=Math.abs(b),{a:o,b:k.b,d:b,duration:_,start:k.start,end:k.start+_,group:k.group}}function h(k){const{delay:_=0,duration:b=300,easing:d=Ut,tick:A=M,css:W}=i||An,B={start:yn()+_,b:k};k||(B.group=fe,fe.r+=1),r||u?u=B:(W&&(a(),c=ht(t,o,k,b,_,d,W)),k&&A(0,1),r=f(B,b),Ce(()=>Ge(t,k,"start")),gn(T=>{if(u&&T>u.start&&(r=f(u,b),u=null,Ge(t,r.b,"start"),W&&(a(),c=ht(t,o,r.b,r.duration,0,d,i.css))),r){if(T>=r.end)A(o=r.b,1-o),Ge(t,r.b,"end"),u||(r.b?a():--r.group.r||te(r.group.c)),r=null;else if(T>=r.start){const N=T-r.start;o=r.a+r.d*d(N/r.duration),A(o,1-o)}}return!!(r||u)}))}return{run(k){me(i)?Pn().then(()=>{i=i(s),h(k)}):h(k)},end(){a(),r=u=null}}}function yt(t,e){const n=e.token={};function l(s,i,o,r){if(e.token!==n)return;e.resolved=r;let u=e.ctx;o!==void 0&&(u=u.slice(),u[o]=r);const c=s&&(e.current=s)(u);let a=!1;e.block&&(e.blocks?e.blocks.forEach((f,h)=>{h!==i&&f&&(Q(),S(f,1,1,()=>{e.blocks[h]===f&&(e.blocks[h]=null)}),X())}):e.block.d(1),c.c(),E(c,1),c.m(e.mount(),e.anchor),a=!0),e.block=c,e.blocks&&(e.blocks[i]=c),a&&$e()}if(hn(t)){const s=Be();if(t.then(i=>{ae(s),l(e.then,1,e.value,i),ae(null)},i=>{if(ae(s),l(e.catch,2,e.error,i),ae(null),!e.hasCatch)throw i}),e.current!==e.pending)return l(e.pending,0),!0}else{if(e.current!==e.then)return l(e.then,1,e.value,t),!0;e.resolved=t}}function Rn(t,e,n){const l=e.slice(),{resolved:s}=t;t.current===t.then&&(l[t.value]=s),t.current===t.catch&&(l[t.error]=s),t.block.p(l,n)}const jn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Z(t){t&&t.c()}function Y(t,e,n,l){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),l||Ce(()=>{const o=t.$$.on_mount.map(qt).filter(me);t.$$.on_destroy?t.$$.on_destroy.push(...o):te(o),t.$$.on_mount=[]}),i.forEach(Ce)}function G(t,e){const n=t.$$;n.fragment!==null&&(te(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function In(t,e){t.$$.dirty[0]===-1&&(we.push(t),Ln(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ie(t,e,n,l,s,i,o,r=[-1]){const u=Oe;ae(t);const c=t.$$={fragment:null,ctx:[],props:i,update:M,not_equal:s,bound:bt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:bt(),dirty:r,skip_bound:!1,root:e.target||u.$$.root};o&&o(c.root);let a=!1;if(c.ctx=n?n(t,e.props||{},(f,h,...k)=>{const _=k.length?k[0]:h;return c.ctx&&s(c.ctx[f],c.ctx[f]=_)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](_),a&&In(t,f)),h}):[],c.update(),a=!0,te(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const f=kn(e.target);c.fragment&&c.fragment.l(f),f.forEach(g)}else c.fragment&&c.fragment.c();e.intro&&E(t.$$.fragment),Y(t,e.target,e.anchor,e.customElement),$e()}ae(u)}class oe{$destroy(){G(this,1),this.$destroy=M}$on(e,n){if(!me(n))return M;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const s=l.indexOf(n);s!==-1&&l.splice(s,1)}}$set(e){this.$$set&&!pn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ge=[];function gt(t,e=M){let n;const l=new Set;function s(r){if(ne(t,r)&&(t=r,n)){const u=!ge.length;for(const c of l)c[1](),ge.push(c,t);if(u){for(let c=0;c<ge.length;c+=2)ge[c][0](ge[c+1]);ge.length=0}}}function i(r){s(r(t))}function o(r,u=M){const c=[r,u];return l.add(c),l.size===1&&(n=e(s)||M),r(t),()=>{l.delete(c),l.size===0&&(n(),n=null)}}return{set:s,update:i,subscribe:o}}let de=window;function Ve(t,e="application/octet-stream"){let n=de.FS.readFile(t);var l=document.createElement("a");l.download=t,l.href=URL.createObjectURL(new Blob([n],{type:e})),l.style.display="none",document.body.appendChild(l),l.click(),setTimeout(()=>{document.body.removeChild(l),URL.revokeObjectURL(l.href)},2e3)}const wt=1<<0,vt=1<<1,kt=1<<2;function Ct(t){return new Promise(e=>{var n=window,l=document.createElement("input");l.type="file",l.onchange=function(s){var i=s.target.files[0],o=new FileReader;o.readAsArrayBuffer(i),t==null&&(t=i.name),o.onload=function(){var r=o.result,u=new Uint8Array(r),c=n.FS.open(t,"w+");n.FS.write(c,u,0,u.length),n.FS.close(c),e(t)}},l.click()})}class Bt{constructor(e,n,l,s,i,o,r){this.device=e,this.name=n,this.type=l,this.native=s,this.children=i,this.parent=o,this.dataType=r}call(e,n="void",l=[],s=[]){return Module.ccall(e,n,["number","number",...l],[this.device.ptr,this.native,...s],{async:!0})}async read(){let e;return de.var_file=(n,l)=>{e=Module.UTF8ToString(n,l)},await this.call("recv_var","void",["number"],[this.dataType=="vars"?1:0]),e}async delete(e=!1){await this.call("del_var"),e||await this.device.list_dir()}}class Wt{constructor(e,n,l){Re(this,"entries");this.native=e,this.device=n,this.type=l;let s=null,i=this.entries=new Bt(this.device,"",0,0,[],null,l);de.tree_value=(o,r,u,c)=>{s=new Bt(this.device,Module.UTF8ToString(o,r),u,c,[],i,this.type),i.children.push(s)},de.tree_children=()=>{i=s},de.tree_parent=()=>{i=s.parent}}call(e,n="void",l=[],s=[]){return Module.ccall(e,n,["number",...l],[this.native,...s],{async:!0})}simplify(){let e=this.entries;for(;e.children.length==1&&e.name=="";)e=e.children[0];return e}destroy(){return this.call("destroy_list")}}class Un{constructor(e,n){Re(this,"apps",gt(null));Re(this,"vars",gt(null));this.calc=e,this.ptr=n}call(e,n="void",l=[],s=[]){return Module.ccall(e,n,["number",...l],[this.ptr,...s],{async:!0})}send_key(e){return this.call("calc_send_key","number",["number"],[e])}async backup(e){let n=await this.call("calc_backup","number",["number"],[e]);if(n!=0)throw new Error("failed to backup! "+n)}async restore(e){if(await this.call("calc_restore","number",["number"],[e])!=0)throw new Error("failed to restore!");await this.list_dir()}async read_files(e){let n;de.var_file=(o,r)=>{n=Module.UTF8ToString(o,r)};var l=this.call("malloc","number",["number"],[e.length*4]);let s=new Uint32Array(e.map(o=>o.native));if(Module.HEAPU8.set(new Uint8Array(s.buffer),l),await this.call("recv_var_multiple","void",["number","number"],[e.length,l])==515)throw new Error("group too big!");return n}async send_file(e){let n=Module.allocateUTF8(e),l=await this.call("load_file","number",["number"],[n])==0;return await Module.ccall("free","void",["number"],[n],{async:!0}),await this.list_dir(),l}async ready(){return await this.call("calc_ready","number")==1}async destroy(){ee(this.vars)!=null&&await ee(this.vars).destroy(),ee(this.apps)!=null&&await ee(this.apps).destroy(),await this.call("destroy_dev")}async recv_screen(){let e;return de.frame=(n,l,s,i)=>{let o=new Uint8ClampedArray(Module.HEAPU8.buffer,n,l);e=new ImageData(o,s,i)},await this.call("recv_screen"),e}async list_dir(){await this.ready(),de.tree_sending=(e,n)=>{e=="vars"&&(ee(this.vars)!=null&&ee(this.vars).destroy(),this.vars.set(new Wt(n,this,e))),e=="apps"&&(ee(this.apps)!=null&&ee(this.apps).destroy(),this.apps.set(new Wt(n,this,e)))},await this.call("list_dir"),this.apps.set(ee(this.apps)),this.vars.set(ee(this.vars))}}async function Ze(){let t=[];return de.found_calc=(e,n,l,s)=>{var i=Module.UTF8ToString(e,n);t.push({name:i,model:l,port:s})},await Module.ccall("list_devices","number",[],[],{async:!0}),t}async function Xt(t){let e=await Module.ccall("connect_device","number",["number","number"],[t.port,t.model],{async:!0});if(e==0)throw new Error("Failed to connect!");return new Un(t,e)}async function qn(){return await Module.ccall("stitch_rom_segments","void",[],[],{async:!0})}function Nn(){return navigator.usb.requestDevice({filters:[{vendorId:1105,productId:57352}]})}function Hn(t){let e,n,l,s,i,o,r,u;const c=t[3].default,a=Nt(c,t,t[2],null);return{c(){e=y("label"),a&&a.c(),n=O(),l=y("input"),s=O(),i=y("span"),p(l,"type","checkbox"),l.checked=t[0],p(l,"class","svelte-apbl1t"),p(i,"class","checkmark svelte-apbl1t"),p(e,"class","container svelte-apbl1t"),F(e,"margin-bottom",t[1]+"px")},m(f,h){w(f,e,h),a&&a.m(e,null),v(e,n),v(e,l),v(e,s),v(e,i),o=!0,r||(u=R(l,"change",t[4]),r=!0)},p(f,[h]){a&&a.p&&(!o||h&4)&&Vt(a,c,f,f[2],o?zt(c,f[2],h,null):Kt(f[2]),null),(!o||h&1)&&(l.checked=f[0]),(!o||h&2)&&F(e,"margin-bottom",f[1]+"px")},i(f){o||(E(a,f),o=!0)},o(f){S(a,f),o=!1},d(f){f&&g(e),a&&a.d(f),r=!1,u()}}}function zn(t,e,n){let{$$slots:l={},$$scope:s}=e,{checked:i}=e,{margin:o=12}=e;function r(u){Fn.call(this,t,u)}return t.$$set=u=>{"checked"in u&&n(0,i=u.checked),"margin"in u&&n(1,o=u.margin),"$$scope"in u&&n(2,s=u.$$scope)},[i,o,s,l,r]}class xt extends oe{constructor(e){super(),ie(this,e,zn,Hn,ne,{checked:0,margin:1})}}function Tt(t,e,n){const l=t.slice();return l[7]=e[n],l}function Vn(t){let e=t[7].name+"",n;return{c(){n=I(e)},m(l,s){w(l,n,s)},p:M,d(l){l&&g(n)}}}function Et(t){let e,n,l;function s(){return t[5](t[7])}return n=new xt({props:{checked:!!(t[2]&t[7].value),$$slots:{default:[Vn]},$$scope:{ctx:t}}}),n.$on("change",s),{c(){e=y("div"),Z(n.$$.fragment)},m(i,o){w(i,e,o),Y(n,e,null),l=!0},p(i,o){t=i;const r={};o&4&&(r.checked=!!(t[2]&t[7].value)),o&1024&&(r.$$scope={dirty:o,ctx:t}),n.$set(r)},i(i){l||(E(n.$$.fragment,i),l=!0)},o(i){S(n.$$.fragment,i),l=!1},d(i){i&&g(e),G(n)}}}function Kn(t){let e,n,l=t[0]?"backup":"restore",s,i,o,r,u,c,a=t[0]?"Start Backup":"Start Restore",f,h,k,_,b=t[4],d=[];for(let W=0;W<b.length;W+=1)d[W]=Et(Tt(t,b,W));const A=W=>S(d[W],1,1,()=>{d[W]=null});return{c(){e=y("h1"),n=I("Choose what to "),s=I(l),i=O();for(let W=0;W<d.length;W+=1)d[W].c();o=O(),r=y("button"),u=y("span"),u.textContent="done",c=O(),f=I(a),F(e,"width","14em"),p(u,"class","material-symbols-outlined"),F(r,"margin-top","5px"),F(r,"padding-left","0")},m(W,B){w(W,e,B),v(e,n),v(e,s),w(W,i,B);for(let T=0;T<d.length;T+=1)d[T].m(W,B);w(W,o,B),w(W,r,B),v(r,u),v(r,c),v(r,f),h=!0,k||(_=R(r,"click",t[6]),k=!0)},p(W,[B]){if((!h||B&1)&&l!==(l=W[0]?"backup":"restore")&&he(s,l),B&20){b=W[4];let T;for(T=0;T<b.length;T+=1){const N=Tt(W,b,T);d[T]?(d[T].p(N,B),E(d[T],1)):(d[T]=Et(N),d[T].c(),E(d[T],1),d[T].m(o.parentNode,o))}for(Q(),T=b.length;T<d.length;T+=1)A(T);X()}(!h||B&1)&&a!==(a=W[0]?"Start Backup":"Start Restore")&&he(f,a)},i(W){if(!h){for(let B=0;B<b.length;B+=1)E(d[B]);h=!0}},o(W){d=d.filter(Boolean);for(let B=0;B<d.length;B+=1)S(d[B]);h=!1},d(W){W&&g(e),W&&g(i),qe(d,W),W&&g(o),W&&g(r),k=!1,_()}}}function Yn(t,e,n){let{backup:l}=e,{cb:s}=e;const{close:i}=Qt("simple-modal");let o=kt|wt|vt,r=[{value:kt,name:"Apps"},{value:wt,name:"RAM vars"},{value:vt,name:"FLASH vars"}];const u=a=>{o&a.value?n(2,o&=~a.value):n(2,o|=a.value)},c=()=>{i(),s(o)};return t.$$set=a=>{"backup"in a&&n(0,l=a.backup),"cb"in a&&n(1,s=a.cb)},[l,s,o,i,r,u,c]}class Ot extends oe{constructor(e){super(),ie(this,e,Yn,Kn,ne,{backup:0,cb:1})}}function Gn(t){let e=t[0].name+"",n;return{c(){n=I(e)},m(l,s){w(l,n,s)},p(l,s){s&1&&e!==(e=l[0].name+"")&&he(n,e)},d(l){l&&g(n)}}}function Zn(t){let e,n,l,s,i,o,r,u,c,a,f,h,k;return n=new xt({props:{checked:t[1],margin:0,$$slots:{default:[Gn]},$$scope:{ctx:t}}}),n.$on("change",t[5]),{c(){e=y("div"),Z(n.$$.fragment),l=O(),s=y("div"),i=O(),o=y("button"),r=y("span"),r.textContent="download",u=O(),c=y("button"),a=y("span"),a.textContent="delete",F(s,"flex-grow","1"),p(r,"class","material-symbols-outlined"),o.disabled=t[3],p(a,"class","material-symbols-outlined"),F(a,"color","var(--danger)"),c.disabled=t[3],p(e,"class","row svelte-1yrndbo"),F(e,"border-top",(t[2]?0:1)+"px solid #ccc")},m(_,b){w(_,e,b),Y(n,e,null),v(e,l),v(e,s),v(e,i),v(e,o),v(o,r),v(e,u),v(e,c),v(c,a),f=!0,h||(k=[R(o,"click",t[6]),R(c,"click",t[7])],h=!0)},p(_,[b]){const d={};b&2&&(d.checked=_[1]),b&257&&(d.$$scope={dirty:b,ctx:_}),n.$set(d),(!f||b&8)&&(o.disabled=_[3]),(!f||b&8)&&(c.disabled=_[3]),(!f||b&4)&&F(e,"border-top",(_[2]?0:1)+"px solid #ccc")},i(_){f||(E(n.$$.fragment,_),f=!0)},o(_){S(n.$$.fragment,_),f=!1},d(_){_&&g(e),G(n),h=!1,te(k)}}}function Jn(t,e,n){let{entry:l}=e,s=!1,{selected:i=!1}=e,{first:o=!1}=e,r=xe();const u=()=>r("toggle"),c=async()=>{n(3,s=!0);let f=await l.read();Ve(f),n(3,s=!1)},a=async()=>{confirm("Are you sure you want to delete this variable?")&&(n(3,s=!0),await l.delete(),n(3,s=!1))};return t.$$set=f=>{"entry"in f&&n(0,l=f.entry),"selected"in f&&n(1,i=f.selected),"first"in f&&n(2,o=f.first)},[l,i,o,s,r,u,c,a]}class $t extends oe{constructor(e){super(),ie(this,e,Jn,Zn,ne,{entry:0,selected:1,first:2})}}function Qn(t){let e,n,l,s,i;return{c(){e=y("h1"),e.textContent="Screen",n=O(),l=y("canvas"),p(l,"width",s=t[0].width),p(l,"height",i=t[0].height),p(l,"class","svelte-1y6s679")},m(o,r){w(o,e,r),w(o,n,r),w(o,l,r),t[2](l)},p(o,[r]){r&1&&s!==(s=o[0].width)&&p(l,"width",s),r&1&&i!==(i=o[0].height)&&p(l,"height",i)},i:M,o:M,d(o){o&&g(e),o&&g(n),o&&g(l),t[2](null)}}}function Xn(t,e,n){let{imageData:l}=e,s;function i(o){ke[o?"unshift":"push"](()=>{s=o,n(1,s)})}return t.$$set=o=>{"imageData"in o&&n(0,l=o.imageData)},t.$$.update=()=>{t.$$.dirty&3&&s!=null&&s.getContext("2d").putImageData(l,0,0)},[l,s,i]}class xn extends oe{constructor(e){super(),ie(this,e,Xn,Qn,ne,{imageData:0})}}function St(t,e,n){const l=t.slice();return l[10]=e[n],l[29]=n,l}function Ft(t,e,n){const l=t.slice();return l[30]=e[n],l[29]=n,l}function $n(t){let e,n,l,s,i,o,r,u,c,a,f,h,k,_,b,d,A,W,B,T,N,j=t[0].calc.name+"",P,H,_e;function q(C,D){return C[4]?nl:tl}let J=q(t),z=J(t);function re(C,D){return C[5]?sl:ll}let x=re(t),V=x(t);return{c(){e=y("button"),n=y("span"),n.textContent="refresh",l=O(),s=y("button"),i=y("span"),i.textContent="upload_file",o=O(),r=y("button"),u=y("span"),z.c(),c=O(),a=y("button"),f=y("span"),V.c(),h=O(),k=y("button"),_=y("span"),_.textContent="screen_share",b=O(),d=y("button"),d.innerHTML='<span class="material-symbols-outlined">link_off</span>',A=O(),W=y("div"),B=O(),T=y("div"),N=I("Connected: "),P=I(j),p(n,"class","material-symbols-outlined"),e.disabled=t[6],p(e,"title","Refresh"),p(i,"class","material-symbols-outlined"),p(s,"title","Upload"),s.disabled=t[3],p(u,"class","material-symbols-outlined"),p(r,"title","Backup"),r.disabled=t[4],p(f,"class","material-symbols-outlined"),F(f,"position","relative"),F(f,"top","2px"),p(a,"title","Restore"),a.disabled=t[5],p(_,"class","material-symbols-outlined"),F(_,"position","relative"),F(_,"top","1px"),p(k,"title","Capture Screen"),k.disabled=t[7],p(d,"title","Disconnect"),F(W,"flex-grow","1"),F(T,"color","var(--success)"),F(T,"font-weight","600"),F(T,"font-size","14px")},m(C,D){w(C,e,D),v(e,n),w(C,l,D),w(C,s,D),v(s,i),w(C,o,D),w(C,r,D),v(r,u),z.m(u,null),w(C,c,D),w(C,a,D),v(a,f),V.m(f,null),w(C,h,D),w(C,k,D),v(k,_),w(C,b,D),w(C,d,D),w(C,A,D),w(C,W,D),w(C,B,D),w(C,T,D),v(T,N),v(T,P),H||(_e=[R(e,"click",t[14]),R(s,"click",t[11]),R(r,"click",t[12]),R(a,"click",t[13]),R(k,"click",t[15]),R(d,"click",t[19])],H=!0)},p(C,D){D[0]&64&&(e.disabled=C[6]),D[0]&8&&(s.disabled=C[3]),J!==(J=q(C))&&(z.d(1),z=J(C),z&&(z.c(),z.m(u,null))),D[0]&16&&(r.disabled=C[4]),x!==(x=re(C))&&(V.d(1),V=x(C),V&&(V.c(),V.m(f,null))),D[0]&32&&(a.disabled=C[5]),D[0]&128&&(k.disabled=C[7]),D[0]&1&&j!==(j=C[0].calc.name+"")&&he(P,j)},d(C){C&&g(e),C&&g(l),C&&g(s),C&&g(o),C&&g(r),z.d(),C&&g(c),C&&g(a),V.d(),C&&g(h),C&&g(k),C&&g(b),C&&g(d),C&&g(A),C&&g(W),C&&g(B),C&&g(T),H=!1,te(_e)}}}function el(t){let e,n=t[8].length+"",l,s,i,o,r,u,c,a,f,h,k,_;return{c(){e=y("div"),l=I(n),s=I(" selected"),i=O(),o=y("div"),r=O(),u=y("button"),c=y("span"),c.textContent="download",a=O(),f=y("button"),h=y("span"),h.textContent="delete",F(e,"font-weight","600"),F(e,"padding-left","10px"),F(o,"flex-grow","1"),p(c,"class","material-symbols-outlined"),u.disabled=t[6],p(u,"title","Refresh"),p(h,"class","material-symbols-outlined"),f.disabled=t[6],p(f,"title","Refresh"),F(f,"color","var(--danger)")},m(b,d){w(b,e,d),v(e,l),v(e,s),w(b,i,d),w(b,o,d),w(b,r,d),w(b,u,d),v(u,c),w(b,a,d),w(b,f,d),v(f,h),k||(_=[R(u,"click",t[17]),R(f,"click",t[18])],k=!0)},p(b,d){d[0]&256&&n!==(n=b[8].length+"")&&he(l,n),d[0]&64&&(u.disabled=b[6]),d[0]&64&&(f.disabled=b[6])},d(b){b&&g(e),b&&g(i),b&&g(o),b&&g(r),b&&g(u),b&&g(a),b&&g(f),k=!1,te(_)}}}function tl(t){let e;return{c(){e=I("save")},m(n,l){w(n,e,l)},d(n){n&&g(e)}}}function nl(t){let e;return{c(){e=I("sync")},m(n,l){w(n,e,l)},d(n){n&&g(e)}}}function ll(t){let e;return{c(){e=I("settings_backup_restore")},m(n,l){w(n,e,l)},d(n){n&&g(e)}}}function sl(t){let e;return{c(){e=I("sync")},m(n,l){w(n,e,l)},d(n){n&&g(e)}}}function Mt(t){let e,n,l,s,i,o,r,u=t[2],c=[];for(let _=0;_<u.length;_+=1)c[_]=Lt(Ft(t,u,_));const a=_=>S(c[_],1,1,()=>{c[_]=null});let f=t[1],h=[];for(let _=0;_<f.length;_+=1)h[_]=Dt(St(t,f,_));const k=_=>S(h[_],1,1,()=>{h[_]=null});return{c(){e=y("h3"),e.textContent="Apps",n=O();for(let _=0;_<c.length;_+=1)c[_].c();l=O(),s=y("h3"),s.textContent="Vars",i=O();for(let _=0;_<h.length;_+=1)h[_].c();o=Se(),p(e,"class","svelte-1unx23w"),p(s,"class","svelte-1unx23w")},m(_,b){w(_,e,b),w(_,n,b);for(let d=0;d<c.length;d+=1)c[d].m(_,b);w(_,l,b),w(_,s,b),w(_,i,b);for(let d=0;d<h.length;d+=1)h[d].m(_,b);w(_,o,b),r=!0},p(_,b){if(b[0]&65796){u=_[2];let d;for(d=0;d<u.length;d+=1){const A=Ft(_,u,d);c[d]?(c[d].p(A,b),E(c[d],1)):(c[d]=Lt(A),c[d].c(),E(c[d],1),c[d].m(l.parentNode,l))}for(Q(),d=u.length;d<c.length;d+=1)a(d);X()}if(b[0]&65794){f=_[1];let d;for(d=0;d<f.length;d+=1){const A=St(_,f,d);h[d]?(h[d].p(A,b),E(h[d],1)):(h[d]=Dt(A),h[d].c(),E(h[d],1),h[d].m(o.parentNode,o))}for(Q(),d=f.length;d<h.length;d+=1)k(d);X()}},i(_){if(!r){for(let b=0;b<u.length;b+=1)E(c[b]);for(let b=0;b<f.length;b+=1)E(h[b]);r=!0}},o(_){c=c.filter(Boolean);for(let b=0;b<c.length;b+=1)S(c[b]);h=h.filter(Boolean);for(let b=0;b<h.length;b+=1)S(h[b]);r=!1},d(_){_&&g(e),_&&g(n),qe(c,_),_&&g(l),_&&g(s),_&&g(i),qe(h,_),_&&g(o)}}}function Lt(t){let e,n;function l(){return t[22](t[30])}return e=new $t({props:{first:t[29]==0,entry:t[30],selected:t[8].includes(t[30])}}),e.$on("toggle",l),{c(){Z(e.$$.fragment)},m(s,i){Y(e,s,i),n=!0},p(s,i){t=s;const o={};i[0]&4&&(o.entry=t[30]),i[0]&260&&(o.selected=t[8].includes(t[30])),e.$set(o)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){G(e,s)}}}function Dt(t){let e,n;function l(){return t[23](t[10])}return e=new $t({props:{first:t[29]==0,entry:t[10],selected:t[8].includes(t[10])}}),e.$on("toggle",l),{c(){Z(e.$$.fragment)},m(s,i){Y(e,s,i),n=!0},p(s,i){t=s;const o={};i[0]&2&&(o.entry=t[10]),i[0]&258&&(o.selected=t[8].includes(t[10])),e.$set(o)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){S(e.$$.fragment,s),n=!1},d(s){G(e,s)}}}function il(t){let e,n,l,s,i,o;function r(f,h){return f[8].length>0?el:$n}let u=r(t),c=u(t),a=t[2]!=null&&t[1]!=null&&Mt(t);return{c(){e=y("main"),n=y("div"),l=y("div"),c.c(),s=O(),i=y("div"),a&&a.c(),p(l,"class","toolbar svelte-1unx23w"),p(i,"class","list svelte-1unx23w"),p(n,"class","center svelte-1unx23w"),p(e,"class","svelte-1unx23w")},m(f,h){w(f,e,h),v(e,n),v(n,l),c.m(l,null),v(n,s),v(n,i),a&&a.m(i,null),o=!0},p(f,h){u===(u=r(f))&&c?c.p(f,h):(c.d(1),c=u(f),c&&(c.c(),c.m(l,null))),f[2]!=null&&f[1]!=null?a?(a.p(f,h),h[0]&6&&E(a,1)):(a=Mt(f),a.c(),E(a,1),a.m(i,null)):a&&(Q(),S(a,1,1,()=>{a=null}),X())},i(f){o||(E(a),o=!0)},o(f){S(a),o=!1},d(f){f&&g(e),c.d(),a&&a.d()}}}function ol(t,e,n){let l,s,i,o,r,u=M,c=()=>(u(),u=Je(s,L=>n(20,r=L)),s),a,f=M,h=()=>(f(),f=Je(l,L=>n(21,a=L)),l);t.$$.on_destroy.push(()=>u()),t.$$.on_destroy.push(()=>f());const{open:k}=Qt("simple-modal");let{device:_}=e;function b(L,U){n(8,q=q.map($=>L.concat(U).find(be=>be.type==$.type&&be.name==$.name)).filter($=>$!=null))}let d=!1;async function A(){let L=await Ct();n(3,d=!0),await _.send_file(L),n(3,d=!1)}let W=!1;function B(){k(Ot,{backup:!0,cb:async L=>{n(4,W=!0),await _.backup(L),Ve("backup.tig"),n(4,W=!1)}})}let T=!1;async function N(){k(Ot,{backup:!1,cb:async L=>{await Ct("backup.tig"),n(5,T=!0),await _.restore(L),n(5,T=!1)}})}let j=!1;async function P(){n(6,j=!0),await _.list_dir(),n(6,j=!1)}let H=!1;async function _e(){n(7,H=!0);let L=await _.recv_screen();k(xn,{imageData:L}),n(7,H=!1)}let q=[];function J(L){q.includes(L)?q.splice(q.indexOf(L),1):q.push(L),n(8,q)}async function z(){let L;try{L=await _.read_files(q)}catch(U){console.error(U),alert("Selected size exceeds max! (64kb)");return}Ve(L)}async function re(){if(confirm("Are you sure you want to delete these variables?")){for(const L of q)await L.delete(!0);await _.list_dir()}}let x=xe();function V(){x("disconnect")}const C=L=>J(L),D=L=>J(L);return t.$$set=L=>{"device"in L&&n(0,_=L.device)},t.$$.update=()=>{t.$$.dirty[0]&1&&h(n(9,l=_.apps)),t.$$.dirty[0]&1&&c(n(10,s=_.vars)),t.$$.dirty[0]&2097152&&n(2,i=a==null?void 0:a.simplify().children),t.$$.dirty[0]&1048576&&n(1,o=r==null?void 0:r.simplify().children),t.$$.dirty[0]&6&&b(i,o)},[_,o,i,d,W,T,j,H,q,l,s,A,B,N,P,_e,J,z,re,V,r,a,C,D]}class rl extends oe{constructor(e){super(),ie(this,e,ol,il,ne,{device:0},null,[-1,-1])}}function cl(t,{delay:e=0,duration:n=400,easing:l=Ut}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:l,css:i=>`opacity: ${i*s}`}}const{window:ul}=jn;function Pt(t){let e,n,l,s,i,o,r,u,c,a,f,h,k,_,b,d,A,W,B=t[1].closeButton&&At(t);var T=t[2];function N(j){return{}}return T&&(o=Ne(T,N())),{c(){e=y("div"),n=y("div"),l=y("div"),B&&B.c(),s=O(),i=y("div"),o&&Z(o.$$.fragment),p(i,"class",r=le(t[1].classContent)+" svelte-n7cvum"),p(i,"style",t[9]),se(i,"content",!t[0]),p(l,"class",u=le(t[1].classWindow)+" svelte-n7cvum"),p(l,"role","dialog"),p(l,"aria-modal","true"),p(l,"aria-label",c=t[1].ariaLabelledBy?null:t[1].ariaLabel||null),p(l,"aria-labelledby",a=t[1].ariaLabelledBy||null),p(l,"style",t[8]),se(l,"window",!t[0]),p(n,"class",h=le(t[1].classWindowWrap)+" svelte-n7cvum"),p(n,"style",t[7]),se(n,"wrap",!t[0]),p(e,"id",k=t[1].id),p(e,"class",_=le(t[1].classBg)+" svelte-n7cvum"),p(e,"style",t[6]),se(e,"bg",!t[0])},m(j,P){w(j,e,P),v(e,n),v(n,l),B&&B.m(l,null),v(l,s),v(l,i),o&&Y(o,i,null),t[50](l),t[51](n),t[52](e),d=!0,A||(W=[R(l,"introstart",function(){me(t[13])&&t[13].apply(this,arguments)}),R(l,"outrostart",function(){me(t[14])&&t[14].apply(this,arguments)}),R(l,"introend",function(){me(t[15])&&t[15].apply(this,arguments)}),R(l,"outroend",function(){me(t[16])&&t[16].apply(this,arguments)}),R(e,"mousedown",t[20]),R(e,"mouseup",t[21])],A=!0)},p(j,P){if(t=j,t[1].closeButton?B?(B.p(t,P),P[0]&2&&E(B,1)):(B=At(t),B.c(),E(B,1),B.m(l,s)):B&&(Q(),S(B,1,1,()=>{B=null}),X()),T!==(T=t[2])){if(o){Q();const H=o;S(H.$$.fragment,1,0,()=>{G(H,1)}),X()}T?(o=Ne(T,N()),Z(o.$$.fragment),E(o.$$.fragment,1),Y(o,i,null)):o=null}(!d||P[0]&2&&r!==(r=le(t[1].classContent)+" svelte-n7cvum"))&&p(i,"class",r),(!d||P[0]&512)&&p(i,"style",t[9]),(!d||P[0]&3)&&se(i,"content",!t[0]),(!d||P[0]&2&&u!==(u=le(t[1].classWindow)+" svelte-n7cvum"))&&p(l,"class",u),(!d||P[0]&2&&c!==(c=t[1].ariaLabelledBy?null:t[1].ariaLabel||null))&&p(l,"aria-label",c),(!d||P[0]&2&&a!==(a=t[1].ariaLabelledBy||null))&&p(l,"aria-labelledby",a),(!d||P[0]&256)&&p(l,"style",t[8]),(!d||P[0]&3)&&se(l,"window",!t[0]),(!d||P[0]&2&&h!==(h=le(t[1].classWindowWrap)+" svelte-n7cvum"))&&p(n,"class",h),(!d||P[0]&128)&&p(n,"style",t[7]),(!d||P[0]&3)&&se(n,"wrap",!t[0]),(!d||P[0]&2&&k!==(k=t[1].id))&&p(e,"id",k),(!d||P[0]&2&&_!==(_=le(t[1].classBg)+" svelte-n7cvum"))&&p(e,"class",_),(!d||P[0]&64)&&p(e,"style",t[6]),(!d||P[0]&3)&&se(e,"bg",!t[0])},i(j){d||(E(B),o&&E(o.$$.fragment,j),Ce(()=>{f||(f=je(l,t[12],t[1].transitionWindowProps,!0)),f.run(1)}),Ce(()=>{b||(b=je(e,t[11],t[1].transitionBgProps,!0)),b.run(1)}),d=!0)},o(j){S(B),o&&S(o.$$.fragment,j),f||(f=je(l,t[12],t[1].transitionWindowProps,!1)),f.run(0),b||(b=je(e,t[11],t[1].transitionBgProps,!1)),b.run(0),d=!1},d(j){j&&g(e),B&&B.d(),o&&G(o),t[50](null),j&&f&&f.end(),t[51](null),t[52](null),j&&b&&b.end(),A=!1,te(W)}}}function At(t){let e,n,l,s,i;const o=[fl,al],r=[];function u(c,a){return a[0]&2&&(e=null),e==null&&(e=!!c[17](c[1].closeButton)),e?0:1}return n=u(t,[-1,-1,-1]),l=r[n]=o[n](t),{c(){l.c(),s=Se()},m(c,a){r[n].m(c,a),w(c,s,a),i=!0},p(c,a){let f=n;n=u(c,a),n===f?r[n].p(c,a):(Q(),S(r[f],1,1,()=>{r[f]=null}),X(),l=r[n],l?l.p(c,a):(l=r[n]=o[n](c),l.c()),E(l,1),l.m(s.parentNode,s))},i(c){i||(E(l),i=!0)},o(c){S(l),i=!1},d(c){r[n].d(c),c&&g(s)}}}function al(t){let e,n,l,s;return{c(){e=y("button"),p(e,"class",n=le(t[1].classCloseButton)+" svelte-n7cvum"),p(e,"aria-label","Close modal"),p(e,"style",t[10]),p(e,"type","button"),se(e,"close",!t[0])},m(i,o){w(i,e,o),l||(s=R(e,"click",t[18]),l=!0)},p(i,o){o[0]&2&&n!==(n=le(i[1].classCloseButton)+" svelte-n7cvum")&&p(e,"class",n),o[0]&1024&&p(e,"style",i[10]),o[0]&3&&se(e,"close",!i[0])},i:M,o:M,d(i){i&&g(e),l=!1,s()}}}function fl(t){let e,n,l;var s=t[1].closeButton;function i(o){return{props:{onClose:o[18]}}}return s&&(e=Ne(s,i(t))),{c(){e&&Z(e.$$.fragment),n=Se()},m(o,r){e&&Y(e,o,r),w(o,n,r),l=!0},p(o,r){if(s!==(s=o[1].closeButton)){if(e){Q();const u=e;S(u.$$.fragment,1,0,()=>{G(u,1)}),X()}s?(e=Ne(s,i(o)),Z(e.$$.fragment),E(e.$$.fragment,1),Y(e,n.parentNode,n)):e=null}},i(o){l||(e&&E(e.$$.fragment,o),l=!0)},o(o){e&&S(e.$$.fragment,o),l=!1},d(o){o&&g(n),e&&G(e,o)}}}function dl(t){let e,n,l,s,i=t[2]&&Pt(t);const o=t[49].default,r=Nt(o,t,t[48],null);return{c(){i&&i.c(),e=O(),r&&r.c()},m(u,c){i&&i.m(u,c),w(u,e,c),r&&r.m(u,c),n=!0,l||(s=R(ul,"keydown",t[19]),l=!0)},p(u,c){u[2]?i?(i.p(u,c),c[0]&4&&E(i,1)):(i=Pt(u),i.c(),E(i,1),i.m(e.parentNode,e)):i&&(Q(),S(i,1,1,()=>{i=null}),X()),r&&r.p&&(!n||c[1]&131072)&&Vt(r,o,u,u[48],n?zt(o,u[48],c,null):Kt(u[48]),null)},i(u){n||(E(i),E(r,u),n=!0)},o(u){S(i),S(r,u),n=!1},d(u){i&&i.d(u),u&&g(e),r&&r.d(u),l=!1,s()}}}function _l(t,e={}){return function(l){return new t({...l,props:{...e,...l.props}})}}function ml(t,e,n){let{$$slots:l={},$$scope:s}=e;const i=xe(),o=Sn,r=m=>m.tabIndex>=0&&!m.hidden&&!m.disabled&&m.style.display!=="none"&&m.type!=="hidden"&&Boolean(m.offsetWidth||m.offsetHeight||m.getClientRects().length);let{isTabbable:u=r}=e,{show:c=null}=e,{id:a=null}=e,{key:f="simple-modal"}=e,{ariaLabel:h=null}=e,{ariaLabelledBy:k=null}=e,{closeButton:_=!0}=e,{closeOnEsc:b=!0}=e,{closeOnOuterClick:d=!0}=e,{styleBg:A={}}=e,{styleWindowWrap:W={}}=e,{styleWindow:B={}}=e,{styleContent:T={}}=e,{styleCloseButton:N={}}=e,{classBg:j=null}=e,{classWindowWrap:P=null}=e,{classWindow:H=null}=e,{classContent:_e=null}=e,{classCloseButton:q=null}=e,{unstyled:J=!1}=e,{setContext:z=o}=e,{transitionBg:re=cl}=e,{transitionBgProps:x={duration:250}}=e,{transitionWindow:V=re}=e,{transitionWindowProps:C=x}=e,{disableFocusTrap:D=!1}=e;const L={id:a,ariaLabel:h,ariaLabelledBy:k,closeButton:_,closeOnEsc:b,closeOnOuterClick:d,styleBg:A,styleWindowWrap:W,styleWindow:B,styleContent:T,styleCloseButton:N,classBg:j,classWindowWrap:P,classWindow:H,classContent:_e,classCloseButton:q,transitionBg:re,transitionBgProps:x,transitionWindow:V,transitionWindowProps:C,disableFocusTrap:D,isTabbable:u,unstyled:J};let U={...L},$=null,be,Fe,Me,Ke,et,tt,nt,lt,st,it,ot,rt,ct,ut,at;const tn=m=>m.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase(),We=m=>m?Object.keys(m).reduce((Te,ce)=>`${Te}; ${tn(ce)}: ${m[ce]}`,""):"",ft=m=>!!(m&&m.constructor&&m.call&&m.apply),nn=()=>{n(6,et=We(Object.assign({},{width:window.innerWidth,height:window.innerHeight},U.styleBg))),n(7,tt=We(U.styleWindowWrap)),n(8,nt=We(U.styleWindow)),n(9,lt=We(U.styleContent)),n(10,st=We(U.styleCloseButton)),n(11,it=U.transitionBg),n(12,ot=U.transitionWindow)},Le=()=>{};let dt=Le,De=Le,_t=Le,Pe=Le;const mt=(m,Te={},ce={},K={})=>{n(2,$=_l(m,Te)),n(1,U={...L,...ce}),nn(),rn(),n(13,dt=ue=>{K.onOpen&&K.onOpen(ue),i("open"),i("opening")}),n(14,De=ue=>{K.onClose&&K.onClose(ue),i("close"),i("closing")}),n(15,_t=ue=>{K.onOpened&&K.onOpened(ue),i("opened")}),n(16,Pe=ue=>{K.onClosed&&K.onClosed(ue),i("closed")})},pe=(m={})=>{$&&(n(14,De=m.onClose||De),n(16,Pe=m.onClosed||Pe),n(2,$=null),cn())},ln=m=>{if(U.closeOnEsc&&$&&m.key==="Escape"&&(m.preventDefault(),pe()),$&&m.key==="Tab"&&!U.disableFocusTrap){const Te=Me.querySelectorAll("*"),ce=Array.from(Te).filter(U.isTabbable).sort((ue,dn)=>ue.tabIndex-dn.tabIndex);let K=ce.indexOf(document.activeElement);K===-1&&m.shiftKey&&(K=0),K+=ce.length+(m.shiftKey?-1:1),K%=ce.length,ce[K].focus(),m.preventDefault()}},sn=m=>{U.closeOnOuterClick&&(m.target===be||m.target===Fe)&&(at=m.target)},on=m=>{U.closeOnOuterClick&&m.target===at&&(m.preventDefault(),pe())},rn=()=>{Ke=window.scrollY,rt=document.body.style.position,ct=document.body.style.overflow,ut=document.body.style.width,document.body.style.position="fixed",document.body.style.top=`-${Ke}px`,document.body.style.overflow="hidden",document.body.style.width="100%"},cn=()=>{document.body.style.position=rt||"",document.body.style.top="",document.body.style.overflow=ct||"",document.body.style.width=ut||"",window.scrollTo({top:Ke,left:0,behavior:"instant"})};z(f,{open:mt,close:pe});let Ae=!1;On(()=>{Ae&&pe()}),En(()=>{n(47,Ae=!0)});function un(m){ke[m?"unshift":"push"](()=>{Me=m,n(5,Me)})}function an(m){ke[m?"unshift":"push"](()=>{Fe=m,n(4,Fe)})}function fn(m){ke[m?"unshift":"push"](()=>{be=m,n(3,be)})}return t.$$set=m=>{"isTabbable"in m&&n(22,u=m.isTabbable),"show"in m&&n(23,c=m.show),"id"in m&&n(24,a=m.id),"key"in m&&n(25,f=m.key),"ariaLabel"in m&&n(26,h=m.ariaLabel),"ariaLabelledBy"in m&&n(27,k=m.ariaLabelledBy),"closeButton"in m&&n(28,_=m.closeButton),"closeOnEsc"in m&&n(29,b=m.closeOnEsc),"closeOnOuterClick"in m&&n(30,d=m.closeOnOuterClick),"styleBg"in m&&n(31,A=m.styleBg),"styleWindowWrap"in m&&n(32,W=m.styleWindowWrap),"styleWindow"in m&&n(33,B=m.styleWindow),"styleContent"in m&&n(34,T=m.styleContent),"styleCloseButton"in m&&n(35,N=m.styleCloseButton),"classBg"in m&&n(36,j=m.classBg),"classWindowWrap"in m&&n(37,P=m.classWindowWrap),"classWindow"in m&&n(38,H=m.classWindow),"classContent"in m&&n(39,_e=m.classContent),"classCloseButton"in m&&n(40,q=m.classCloseButton),"unstyled"in m&&n(0,J=m.unstyled),"setContext"in m&&n(41,z=m.setContext),"transitionBg"in m&&n(42,re=m.transitionBg),"transitionBgProps"in m&&n(43,x=m.transitionBgProps),"transitionWindow"in m&&n(44,V=m.transitionWindow),"transitionWindowProps"in m&&n(45,C=m.transitionWindowProps),"disableFocusTrap"in m&&n(46,D=m.disableFocusTrap),"$$scope"in m&&n(48,s=m.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&8388608|t.$$.dirty[1]&65536&&Ae&&(ft(c)?mt(c):pe())},[J,U,$,be,Fe,Me,et,tt,nt,lt,st,it,ot,dt,De,_t,Pe,ft,pe,ln,sn,on,u,c,a,f,h,k,_,b,d,A,W,B,T,N,j,P,H,_e,q,z,re,x,V,C,D,Ae,s,l,un,an,fn]}class bl extends oe{constructor(e){super(),ie(this,e,ml,dl,ne,{isTabbable:22,show:23,id:24,key:25,ariaLabel:26,ariaLabelledBy:27,closeButton:28,closeOnEsc:29,closeOnOuterClick:30,styleBg:31,styleWindowWrap:32,styleWindow:33,styleContent:34,styleCloseButton:35,classBg:36,classWindowWrap:37,classWindow:38,classContent:39,classCloseButton:40,unstyled:0,setContext:41,transitionBg:42,transitionBgProps:43,transitionWindow:44,transitionWindowProps:45,disableFocusTrap:46},null,[-1,-1,-1])}}function hl(t){let e,n,l;return{c(){e=y("button"),e.innerHTML='<span class="material-symbols-outlined">close</span>',p(e,"class","inverted svelte-xj41pv")},m(s,i){w(s,e,i),n||(l=R(e,"click",function(){me(t[0])&&t[0].apply(this,arguments)}),n=!0)},p(s,[i]){t=s},i:M,o:M,d(s){s&&g(e),n=!1,l()}}}function pl(t,e,n){let{onClose:l}=e;return t.$$set=s=>{"onClose"in s&&n(0,l=s.onClose)},[l]}class yl extends oe{constructor(e){super(),ie(this,e,pl,hl,ne,{onClose:0})}}function Rt(t,e,n){const l=t.slice();return l[7]=e[n],l}function gl(t){let e;return{c(){e=I("Failed to load devices")},m(n,l){w(n,e,l)},p:M,d(n){n&&g(e)}}}function wl(t){let e,n,l,s,i=t[2],o=[];for(let r=0;r<i.length;r+=1)o[r]=jt(Rt(t,i,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=O(),n=y("button"),n.innerHTML=`<span class="material-symbols-outlined">add</span>
            Add new`,F(n,"margin-top","10px"),F(n,"padding-left","0")},m(r,u){for(let c=0;c<o.length;c+=1)o[c].m(r,u);w(r,e,u),w(r,n,u),l||(s=R(n,"click",t[4]),l=!0)},p(r,u){if(u&15){i=r[2];let c;for(c=0;c<i.length;c+=1){const a=Rt(r,i,c);o[c]?o[c].p(a,u):(o[c]=jt(a),o[c].c(),o[c].m(e.parentNode,e))}for(;c<o.length;c+=1)o[c].d(1);o.length=i.length}},d(r){qe(o,r),r&&g(e),r&&g(n),l=!1,s()}}}function vl(t){let e,n,l,s;function i(){return t[6](t[7])}return{c(){e=y("button"),n=I("Connect"),F(e,"margin-left","auto"),e.disabled=t[1]},m(o,r){w(o,e,r),v(e,n),l||(s=R(e,"click",i),l=!0)},p(o,r){t=o,r&2&&(e.disabled=t[1])},d(o){o&&g(e),l=!1,s()}}}function kl(t){let e;return{c(){e=y("button"),e.innerHTML=`<span class="material-symbols-rounded">warning</span>
                    Wrong model`,F(e,"margin-left","auto"),F(e,"color","var(--danger)")},m(n,l){w(n,e,l)},p:M,d(n){n&&g(e)}}}function jt(t){let e,n=t[7].name+"",l,s,i=t[7].port+"",o,r;function u(f,h){return f[0]!=null&&f[0]!=f[7].model?kl:vl}let c=u(t),a=c(t);return{c(){e=y("div"),l=I(n),s=I(" on port "),o=I(i),r=O(),a.c(),p(e,"class","item svelte-1jolud5")},m(f,h){w(f,e,h),v(e,l),v(e,s),v(e,o),v(e,r),a.m(e,null)},p(f,h){h&4&&n!==(n=f[7].name+"")&&he(l,n),h&4&&i!==(i=f[7].port+"")&&he(o,i),c===(c=u(f))&&a?a.p(f,h):(a.d(1),a=c(f),a&&(a.c(),a.m(e,null)))},d(f){f&&g(e),a.d()}}}function Cl(t){let e;return{c(){e=I("Loading devices...")},m(n,l){w(n,e,l)},p:M,d(n){n&&g(e)}}}function Bl(t){let e,n,l,s,i={ctx:t,current:null,token:null,hasCatch:!0,pending:Cl,then:wl,catch:gl,value:2,error:10};return yt(s=t[2],i),{c(){e=y("h4"),e.textContent="Choose a device:",n=O(),l=y("div"),i.block.c(),p(e,"class","svelte-1jolud5")},m(o,r){w(o,e,r),w(o,n,r),w(o,l,r),i.block.m(l,i.anchor=null),i.mount=()=>l,i.anchor=null},p(o,[r]){t=o,i.ctx=t,r&4&&s!==(s=t[2])&&yt(s,i)||Rn(i,t,r)},i:M,o:M,d(o){o&&g(e),o&&g(n),o&&g(l),i.block.d(),i.token=null,i=null}}}function Wl(t,e,n){let{connect:l}=e,{requiredType:s=null}=e,i=!1;async function o(a){n(1,i=!0),await l(a),n(1,i=!1)}let r=Ze();navigator.usb.addEventListener("disconnect",a=>{n(2,r=Ze())});async function u(){await Nn(),n(2,r=Ze())}const c=a=>o(a);return t.$$set=a=>{"connect"in a&&n(5,l=a.connect),"requiredType"in a&&n(0,s=a.requiredType)},[s,i,r,o,u,l,c]}class en extends oe{constructor(e){super(),ie(this,e,Wl,Bl,ne,{connect:5,requiredType:0})}}function Tl(t){let e,n,l,s,i,o,r,u,c;return{c(){e=y("div"),n=y("p"),n.textContent="Your ROM is ready for download!",l=O(),s=y("div"),i=y("button"),i.textContent="Download",o=O(),r=y("button"),r.innerHTML=`<span class="material-symbols-rounded">login</span>
            Use with CEmu`,F(s,"display","inline-flex"),F(s,"align-items","center"),F(e,"text-align","center")},m(a,f){w(a,e,f),v(e,n),v(e,l),v(e,s),v(s,i),v(s,o),v(s,r),u||(c=[R(i,"click",t[8]),R(r,"click",t[9])],u=!0)},p:M,i:M,o:M,d(a){a&&g(e),u=!1,te(c)}}}function El(t){let e,n,l,s,i,o,r,u,c=t[3]&&It();return{c(){e=y("div"),n=y("p"),n.innerHTML="To dump the ROM, press apps, then CabriJr, then press y=(F1) twice,<br/> select open, select ARTIFICE, then select DUMP, then press mode.",l=O(),c&&c.c(),s=O(),i=y("button"),o=I("Done"),i.disabled=t[2],F(e,"text-align","center")},m(a,f){w(a,e,f),v(e,n),v(e,l),c&&c.m(e,null),v(e,s),v(e,i),v(i,o),r||(u=R(i,"click",t[6]),r=!0)},p(a,f){a[3]?c||(c=It(),c.c(),c.m(e,s)):c&&(c.d(1),c=null),f&4&&(i.disabled=a[2])},i:M,o:M,d(a){a&&g(e),c&&c.d(),r=!1,u()}}}function Ol(t){let e,n,l,s,i,o,r;return{c(){e=y("div"),n=y("p"),n.textContent="Welcome! arTIfiCE will be loaded onto your device, as well as a dumper program",l=O(),s=y("button"),i=I("Load"),s.disabled=t[2],F(e,"text-align","center")},m(u,c){w(u,e,c),v(e,n),v(e,l),v(e,s),v(s,i),o||(r=R(s,"click",t[7]),o=!0)},p(u,c){c&4&&(s.disabled=u[2])},i:M,o:M,d(u){u&&g(e),o=!1,r()}}}function Sl(t){let e,n,l,s,i;return s=new en({props:{connect:t[4],requiredType:20}}),{c(){e=y("div"),n=y("p"),n.textContent="You need a TI-84 Plus CE",l=O(),Z(s.$$.fragment)},m(o,r){w(o,e,r),v(e,n),v(e,l),Y(s,e,null),i=!0},p:M,i(o){i||(E(s.$$.fragment,o),i=!0)},o(o){S(s.$$.fragment,o),i=!1},d(o){o&&g(e),G(s)}}}function It(t){let e;return{c(){e=y("p"),e.textContent="ROM files not found! Ensure you dumped correctly!",F(e,"color","var(--danger)"),F(e,"font-weight","600")},m(n,l){w(n,e,l)},d(n){n&&g(e)}}}function Fl(t){let e,n,l,s;const i=[Sl,Ol,El,Tl],o=[];function r(u,c){return u[0]==null?0:u[1]==0?1:u[1]==1?2:u[1]==2?3:-1}return~(e=r(t))&&(n=o[e]=i[e](t)),{c(){n&&n.c(),l=Se()},m(u,c){~e&&o[e].m(u,c),w(u,l,c),s=!0},p(u,[c]){let a=e;e=r(u),e===a?~e&&o[e].p(u,c):(n&&(Q(),S(o[a],1,1,()=>{o[a]=null}),X()),~e?(n=o[e],n?n.p(u,c):(n=o[e]=i[e](u),n.c()),E(n,1),n.m(l.parentNode,l)):n=null)},i(u){s||(E(n),s=!0)},o(u){S(n),s=!1},d(u){~e&&o[e].d(u),u&&g(l)}}}function Ml(t,e,n){let l,s=async k=>{let _=await Xt(k);await _.ready(),n(0,l=_),window.dev=l},i=0,o=!1,r=!1,u=window;async function c(){n(2,o=!0),n(3,r=!1),await l.list_dir();let k=ee(l.vars).simplify().children.filter(b=>b.name.startsWith("ROMData"));if(k.length==0){n(3,r=!0),n(2,o=!1);return}let _=[];for(const b of k)_.push(await b.read());await qn(),n(2,o=!1),n(1,i++,i)}return[l,i,o,r,s,u,c,async()=>{n(2,o=!0),await l.send_file("dumper-builtin/cabri.8ek"),await l.send_file("dumper-builtin/arTIfiCE.8xv"),await l.send_file("dumper-builtin/dumper.8xp"),n(2,o=!1),n(1,i++,i)},()=>{Ve("ti84PlusCE.rom")},async()=>{u.FS.mkdir("/persist"),u.FS.mount(u.IDBFS,{},"/persist"),await new Promise(k=>u.FS.syncfs(!0,k)),u.FS.writeFile("/persist/r.rom",u.FS.readFile("ti84PlusCE.rom")),await new Promise(k=>u.FS.syncfs(!1,k)),u.FS.unmount("/persist"),window.location.href="/ti"}]}class Ll extends oe{constructor(e){super(),ie(this,e,Ml,Fl,ne,{})}}function Dl(t){let e,n,l,s,i,o;return i=new en({props:{connect:t[2]}}),{c(){e=y("main"),n=y("div"),l=y("h1"),l.textContent="Welcome!",s=O(),Z(i.$$.fragment),p(l,"class","svelte-19n7bqj"),p(n,"class","center svelte-19n7bqj"),p(e,"class","svelte-19n7bqj")},m(r,u){w(r,e,u),v(e,n),v(n,l),v(n,s),Y(i,n,null),o=!0},p:M,i(r){o||(E(i.$$.fragment,r),o=!0)},o(r){S(i.$$.fragment,r),o=!1},d(r){r&&g(e),G(i)}}}function Pl(t){let e,n,l,s,i,o;return i=new Ll({}),{c(){e=y("main"),n=y("div"),l=y("h1"),l.textContent="Dump ROM",s=O(),Z(i.$$.fragment),p(l,"class","svelte-19n7bqj"),p(n,"class","center svelte-19n7bqj"),p(e,"class","svelte-19n7bqj")},m(r,u){w(r,e,u),v(e,n),v(n,l),v(n,s),Y(i,n,null),o=!0},p:M,i(r){o||(E(i.$$.fragment,r),o=!0)},o(r){S(i.$$.fragment,r),o=!1},d(r){r&&g(e),G(i)}}}function Al(t){let e,n;return e=new rl({props:{device:t[0]}}),e.$on("disconnect",t[3]),{c(){Z(e.$$.fragment)},m(l,s){Y(e,l,s),n=!0},p(l,s){const i={};s&1&&(i.device=l[0]),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){G(e,l)}}}function Rl(t){let e,n,l,s,i;const o=[Al,Pl,Dl],r=[];function u(c,a){return c[0]!=null?0:(e==null&&(e=!!window.location.href.includes("?dump")),e?1:2)}return n=u(t),l=r[n]=o[n](t),{c(){l.c(),s=Se()},m(c,a){r[n].m(c,a),w(c,s,a),i=!0},p(c,a){let f=n;n=u(c),n===f?r[n].p(c,a):(Q(),S(r[f],1,1,()=>{r[f]=null}),X(),l=r[n],l?l.p(c,a):(l=r[n]=o[n](c),l.c()),E(l,1),l.m(s.parentNode,s))},i(c){i||(E(l),i=!0)},o(c){S(l),i=!1},d(c){r[n].d(c),c&&g(s)}}}function jl(t){let e,n;return e=new bl({props:{closeButton:t[1],styleWindow:{overflow:"hidden",width:"auto",display:"inline-block",margin:"0 auto;"},styleWindowWrap:{display:"flex"},$$slots:{default:[Rl]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(l,s){Y(e,l,s),n=!0},p(l,[s]){const i={};s&2&&(i.closeButton=l[1]),s&17&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(l){n||(E(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){G(e,l)}}}function Il(t,e,n){let l,s,i=async r=>{let u=await Xt(r);await u.ready(),await u.list_dir(),n(0,s=u),window.dev=s};const o=()=>{s.destroy(),n(0,s=null)};return n(1,l=yl),[s,l,i,o]}class Ul extends oe{constructor(e){super(),ie(this,e,Il,jl,ne,{})}}new Ul({target:document.getElementById("app")});
